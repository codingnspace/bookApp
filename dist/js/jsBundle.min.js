!function(){"use strict";function e(e,t,o){e.state("Home",{url:"/",templateUrl:"views/Home.html"}).state("Create",{url:"/create",templateUrl:"views/create.html"}).state("Register",{url:"/register",templateUrl:"views/register.html"}).state("Login",{url:"/login",templateUrl:"views/login.html"}).state("Profile",{url:"/profile/:id",templateUrl:"views/profile.html"}).state("Edit",{url:"/edit/:id",templateUrl:"views/edit.html"}).state("ReadMore",{url:"/readmore/:id",templateUrl:"views/readmore.html"}),t.otherwise("/"),o.interceptors.push("Auth")}angular.module("app",["ui.router","ngMaterial"]).config(e),e.$inject=["$stateProvider","$urlRouterProvider","$httpProvider"]}(),function(){"use strict";function e(e,t){var o=this;o.newBook={},o.newBook.tags=[],o.createBook=function(){e.createBook(o.newBook).then(function(e){t.go("Home")})}}angular.module("app").controller("CreateBookController",e),e.$inject=["HomeFactory","$state"]}(),function(){"use strict";function e(e,t,o){var r=this;r.booked={},o.getBookById(t.id).then(function(e){r.booked=e}),r.editBook=function(){o.editBook(r.booked).then(function(){console.log("Made it back to the controller for editing"),e.go("Home")})}}angular.module("app").controller("EditBookController",e),e.$inject=["$state","$stateParams","HomeFactory"]}(),function(){"use strict";function e(e,t){var o=this;o.user={},o.status=e.status,o.registerUser=function(){e.registerUser(o.user).then(function(){t.go("Home")})},o.loginUser=function(){e.loginUser(o.user).then(function(){t.go("Home")})},o.logout=function(){e.logout(),t.go("Login")}}angular.module("app").controller("GlobalController",e),e.$inject=["UserFactory","$state"]}(),function(){"use strict";function e(e){var t=this;e.getBooks().then(function(e){t.books=e,console.log("whats up")}),t.deleteBook=function(o){e.deleteBook(o._id).then(function(){t.books.splice(t.books.indexOf(o),1)})}}angular.module("app").controller("HomeController",e),e.$inject=["HomeFactory"]}(),function(){"use strict";function e(e,t){var o=this;o.userBooks={},e.getUserBooks(t.id).then(function(e){o.userBooks=e})}angular.module("app").controller("ProfileController",e),e.$inject=["UserFactory","$stateParams"]}(),function(){"use strict";function e(e,t){var o=this;o.newReview={},t.getBookById(e.id).then(function(e){o.readmore=e,console.log(o.readmore)}),o.addReview=function(){t.addReview(o.newReview,e.id).then(function(e){})}}angular.module("app").controller("ReadMoreController",e),e.$inject=["$stateParams","HomeFactory"]}(),function(){"use strict";function e(e){var t={request:function(t){return e.localStorage.getItem("token")&&(t.headers.authorization="Bearer "+e.localStorage.getItem("token")),t}};return t}angular.module("app").factory("Auth",e),e.$inject=["$window"]}(),function(){"use strict";function e(e,t){var o={};return o.createBook=function(o){var r=t.defer();return e.post("/api/book",o).then(function(){r.resolve()}),r.promise},o.getBookById=function(o){var r=t.defer();return e.get("/api/book/"+o).then(function(e){r.resolve(e.data)}),r.promise},o.addReview=function(o,r){var n=t.defer();return console.log(o+"new review factory"),e.post("/api/book/"+r+"/review",o).then(function(e){n.resolve(e.data)}),n.promise},o.editBook=function(o){var r=t.defer();return e.put("/api/book/"+o._id,o).then(function(e){console.log("madee it to factory, made http req "),r.resolve(e.data),console.log(o+"Edited book")}),r.promise},o.getBooks=function(){var o=t.defer();return e.get("/api/book").then(function(e){o.resolve(e.data)}),o.promise},o.deleteBook=function(o){var r=t.defer();return console.log("I made it to the factory"),e["delete"]("/api/book/"+o).then(function(){r.resolve()}),r.promise},o}angular.module("app").factory("HomeFactory",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t){function o(e){return localStorage.setItem("token",e)}function r(){return localStorage.getItem("token")}function n(){localStorage.removeItem("token")}function a(){var e=JSON.parse(u(r().split(".")[1]));s.status.username=e.username,s.status._id=e._id}function i(){s.status.username=null,s.status._id=null}function u(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}return decodeURIComponent(escape(window.atob(t)))}var s={};return s.status={},s.registerUser=function(r){var n=t.defer();return e.post("/api/user/register",r).then(function(e){o(e.data),a(),n.resolve(e.data)}),n.promise},s.loginUser=function(r){var n=t.defer();return e.post("/api/user/login",r).then(function(e){o(e.data),a(),n.resolve(e.data)}),n.promise},s.logout=function(){n(),i()},r()&&a(),s}angular.module("app").factory("UserFactory",e),e.$inject=["$http","$q"]}();